---
title: "pagelComparison"
output: html_document
---

```{r}
source("R/utils.R")
source("R/mcmc.R")
source("R/functions.R")
load_pkgs()
zmargin <- theme(panel.spacing = grid::unit(0, "lines"))
theme_set(theme_bw())
```

```{r}
data(primates)
phy <- multi2di(primates[[1]])
data <- primates[[2]]
```

```{r statemat}
LegendAndRateMat <- getStateMat4Dat(data)
LegendAndRateMat$legend<-c("0_0","0_1","1_0","1_1")
names(LegendAndRateMat$legend)<-c(1,2,3,4)
LegendAndRateMat$rate.mat<- matrix(c(0,1,2,0,3,0,0,4,5,0,0,6,0,7,8,0), nrow = 4, dimnames = list(c("(1)","(2)","(3)","(4)"), c("(1)","(2)","(3)","(4)")))
RateMat <- LegendAndRateMat$rate.mat
```

```{r ex1,cache=TRUE}
(MK_primate_full <- corHMM(phy = phy, data = data, rate.cat = 1, collapse = FALSE, rate.mat = RateMat))
print(MK_primate_full)
```

```{r}
primate_mcmc <- 
  corhmm_mcmc(MK_primate_full,
              p_args=list(nllfun=make_nllfun(MK_primate_full)),
              ncores = 3,
              nchains = 6,
              ## these are per chain
              n_burnin = 4000,
              n_iter = 44000,
              thin = 10,
              seed = 101)
```

